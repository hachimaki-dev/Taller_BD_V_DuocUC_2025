<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triggers en PL/SQL - Presentación Interactiva</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/sql.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');
        
        * {
            font-family: 'Poppins', sans-serif;
        }
        
        .slide {
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: absolute;
            width: 100%;
            height: 100%;
        }
        
        .slide.active {
            opacity: 1;
            transform: translateX(0);
            position: relative;
        }
        
        .slide.prev {
            transform: translateX(-100%);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .gradient-bg-2 {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .gradient-bg-3 {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .gradient-bg-4 {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        
        .gradient-bg-5 {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }
        
        .code-block {
            background: #282c34;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .nav-btn {
            transition: all 0.3s ease;
        }
        
        .nav-btn:hover {
            transform: scale(1.1);
        }
        
        .slide-indicator {
            transition: all 0.3s ease;
        }
        
        .slide-indicator.active {
            background: white;
            transform: scale(1.2);
        }
        
        .icon-box {
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.3);
        }
    </style>
</head>
<body class="overflow-hidden">
    <div id="presentation" class="relative w-full h-screen overflow-hidden">
        
        <!-- Slide 1: Título -->
        <div class="slide active gradient-bg flex items-center justify-center p-8">
            <div class="text-center text-white">
                <div class="mb-8">
                    <i class="fas fa-database text-8xl mb-6 animate-pulse"></i>
                </div>
                <h1 class="text-7xl font-bold mb-6">Introducción a los Triggers</h1>
                <h2 class="text-4xl font-light mb-8">en PL/SQL</h2>
                <div class="flex justify-center gap-4 text-xl">
                    <span class="px-6 py-3 bg-white bg-opacity-20 rounded-full backdrop-blur-lg">Oracle Database</span>
                    <span class="px-6 py-3 bg-white bg-opacity-20 rounded-full backdrop-blur-lg">Para Taller de Base de Datos</span>
                </div>
            </div>
        </div>

        <!-- Slide 2: Definición -->
        <div class="slide gradient-bg-2 flex items-center justify-center p-8">
            <div class="max-w-5xl text-white">
                <div class="flex items-center mb-12">
                    <i class="fas fa-lightbulb text-6xl mr-6"></i>
                    <h2 class="text-6xl font-bold">¿Qué es un Trigger?</h2>
                </div>
                <div class="bg-white bg-opacity-20 backdrop-blur-lg rounded-3xl p-12 border-2 border-white border-opacity-30">
                    <p class="text-3xl leading-relaxed mb-8">
                        Un <strong>trigger</strong> es un procedimiento almacenado que se ejecuta <strong>automáticamente</strong> cuando ocurre un evento específico en una tabla.
                    </p>
                    <div class="flex items-center justify-center gap-8 text-2xl mt-8">
                        <div class="text-center">
                            <i class="fas fa-plus-circle text-5xl mb-3"></i>
                            <p>INSERT</p>
                        </div>
                        <i class="fas fa-arrow-right text-4xl"></i>
                        <div class="text-center">
                            <i class="fas fa-cog fa-spin text-5xl mb-3"></i>
                            <p>TRIGGER</p>
                        </div>
                        <i class="fas fa-arrow-right text-4xl"></i>
                        <div class="text-center">
                            <i class="fas fa-check-circle text-5xl mb-3"></i>
                            <p>ACCIÓN</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 3: Usos Principales -->
        <div class="slide gradient-bg-3 flex items-center justify-center p-8">
            <div class="max-w-6xl text-white">
                <h2 class="text-6xl font-bold mb-12 text-center">Usos Principales</h2>
                <div class="grid grid-cols-3 gap-8">
                    <div class="icon-box rounded-3xl p-8 text-center transform hover:scale-105 transition-transform">
                        <i class="fas fa-clipboard-check text-6xl mb-6"></i>
                        <h3 class="text-3xl font-bold mb-4">Auditoría</h3>
                        <p class="text-xl">Registrar quién y cuándo modificó los datos</p>
                    </div>
                    <div class="icon-box rounded-3xl p-8 text-center transform hover:scale-105 transition-transform">
                        <i class="fas fa-shield-alt text-6xl mb-6"></i>
                        <h3 class="text-3xl font-bold mb-4">Validación</h3>
                        <p class="text-xl">Verificar reglas de negocio antes de guardar</p>
                    </div>
                    <div class="icon-box rounded-3xl p-8 text-center transform hover:scale-105 transition-transform">
                        <i class="fas fa-magic text-6xl mb-6"></i>
                        <h3 class="text-3xl font-bold mb-4">Automatización</h3>
                        <p class="text-xl">Ejecutar acciones sin intervención manual</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 4: Sintaxis Básica -->
        <div class="slide gradient-bg-4 flex items-center justify-center p-8">
            <div class="max-w-5xl w-full text-white">
                <h2 class="text-6xl font-bold mb-8 text-center">Sintaxis Básica</h2>
                <div class="code-block">
                    <div class="bg-gray-700 px-6 py-3 flex items-center">
                        <i class="fas fa-code mr-3"></i>
                        <span class="font-semibold">Estructura de un Trigger</span>
                    </div>
                    <pre><code class="language-sql" style="font-size: 1.2rem; line-height: 1.8;">CREATE OR REPLACE TRIGGER nombre_trigger
  BEFORE/AFTER INSERT/UPDATE/DELETE
  ON nombre_tabla
  FOR EACH ROW
BEGIN
  -- Código que se ejecuta automáticamente
  -- :NEW.columna → valor nuevo
  -- :OLD.columna → valor anterior
END;
/</code></pre>
                </div>
            </div>
        </div>

        <!-- Slide 5: Tipos de Triggers -->
        <div class="slide gradient-bg-5 flex items-center justify-center p-8">
            <div class="max-w-6xl text-white">
                <h2 class="text-6xl font-bold mb-12 text-center">Tipos de Triggers</h2>
                <div class="space-y-6">
                    <div class="bg-white bg-opacity-20 backdrop-blur-lg rounded-2xl p-8 border-2 border-white border-opacity-30">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-angle-double-left text-4xl mr-4"></i>
                            <h3 class="text-4xl font-bold">BEFORE</h3>
                        </div>
                        <p class="text-2xl ml-16">Se ejecuta <strong>antes</strong> de la operación. Útil para validaciones y modificar valores.</p>
                    </div>
                    <div class="bg-white bg-opacity-20 backdrop-blur-lg rounded-2xl p-8 border-2 border-white border-opacity-30">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-angle-double-right text-4xl mr-4"></i>
                            <h3 class="text-4xl font-bold">AFTER</h3>
                        </div>
                        <p class="text-2xl ml-16">Se ejecuta <strong>después</strong> de la operación. Ideal para auditoría y logs.</p>
                    </div>
                    <div class="bg-white bg-opacity-20 backdrop-blur-lg rounded-2xl p-8 border-2 border-white border-opacity-30">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-exchange-alt text-4xl mr-4"></i>
                            <h3 class="text-4xl font-bold">INSTEAD OF</h3>
                        </div>
                        <p class="text-2xl ml-16">Reemplaza la operación original. Usado principalmente en vistas.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 6: Buenas Prácticas -->
        <div class="slide gradient-bg flex items-center justify-center p-8">
            <div class="max-w-5xl text-white">
                <div class="flex items-center justify-center mb-12">
                    <i class="fas fa-star text-6xl mr-4"></i>
                    <h2 class="text-6xl font-bold">Buenas Prácticas</h2>
                </div>
                <div class="grid grid-cols-2 gap-6">
                    <div class="bg-green-500 bg-opacity-30 backdrop-blur-lg rounded-2xl p-6 border-2 border-green-300">
                        <div class="flex items-start">
                            <i class="fas fa-check-circle text-3xl mr-4 mt-1"></i>
                            <div>
                                <h3 class="text-2xl font-bold mb-2">Sé específico</h3>
                                <p class="text-lg">Define claramente BEFORE/AFTER y el evento (INSERT, UPDATE, DELETE)</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-green-500 bg-opacity-30 backdrop-blur-lg rounded-2xl p-6 border-2 border-green-300">
                        <div class="flex items-start">
                            <i class="fas fa-check-circle text-3xl mr-4 mt-1"></i>
                            <div>
                                <h3 class="text-2xl font-bold mb-2">Mantén código simple</h3>
                                <p class="text-lg">Evita lógica compleja dentro del trigger</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-red-500 bg-opacity-30 backdrop-blur-lg rounded-2xl p-6 border-2 border-red-300">
                        <div class="flex items-start">
                            <i class="fas fa-times-circle text-3xl mr-4 mt-1"></i>
                            <div>
                                <h3 class="text-2xl font-bold mb-2">Evita triggers en cascada</h3>
                                <p class="text-lg">Un trigger que activa otro puede causar problemas</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-red-500 bg-opacity-30 backdrop-blur-lg rounded-2xl p-6 border-2 border-red-300">
                        <div class="flex items-start">
                            <i class="fas fa-times-circle text-3xl mr-4 mt-1"></i>
                            <div>
                                <h3 class="text-2xl font-bold mb-2">Cuidado con el rendimiento</h3>
                                <p class="text-lg">Los triggers se ejecutan en cada fila afectada</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 7: Ejemplo Práctico - Ingredientes -->

        
        <div class="slide gradient-bg-2 flex items-center justify-center p-8">
            <div class="max-w-6xl w-full text-white">
                <h2 class="text-5xl font-bold mb-6 text-center">Ejemplo Práctico: Auditoría de Ingredientes</h2>
                <div class="grid grid-cols-2 gap-6 mb-6">
                    <div class="code-block">
                        <div class="bg-gray-700 px-4 py-2">
                            <span class="font-semibold text-sm">Tabla: ingredientes</span>
                        </div>
                        <pre><code class="language-sql" style="font-size: 0.95rem;">CREATE TABLE ingredientes (
  id_ing NUMBER PRIMARY KEY,
  nombre VARCHAR2(100),
  stock NUMBER
);</code></pre>
                    </div>
                    <div class="code-block">
                        <div class="bg-gray-700 px-4 py-2">
                            <span class="font-semibold text-sm">Tabla: auditoria_ingredientes</span>
                        </div>
                        <pre><code class="language-sql" style="font-size: 0.95rem;">CREATE TABLE auditoria_ingredientes (
  id NUMBER PRIMARY KEY,
  id_ing NUMBER,
  accion VARCHAR2(20),
  fecha DATE,
  usuario VARCHAR2(50)
);</code></pre>
                    </div>
                </div>
                <div class="code-block">
                    <div class="bg-gray-700 px-4 py-2 flex items-center justify-between">
                        <span class="font-semibold">Trigger de Auditoría</span>
                        <i class="fas fa-clipboard-check"></i>
                    </div>
                    <pre><code class="language-sql" style="font-size: 1rem;">
CREATE SEQUENCE seq_ingredientes START WITH 1 INCREMENT BY 1;

CREATE OR REPLACE TRIGGER trg_auditoria_ingredientes
  AFTER INSERT ON ingredientes
  FOR EACH ROW
BEGIN
  INSERT INTO auditoria_ingredientes (id, id_ing, accion, fecha, usuario)
  VALUES (seq_auditoria.NEXTVAL, :NEW.id_ing, 'INSERT', SYSDATE, USER);
END;
/</code></pre>
                </div>
                <div class="bg-white bg-opacity-20 backdrop-blur-lg rounded-xl p-4 mt-4 text-center">
                    <p class="text-lg"><i class="fas fa-info-circle mr-2"></i>La tabla de auditoría registra automáticamente cada inserción en ingredientes</p>
                </div>
            </div>
        </div>

        <!-- Slide 8: Otros Ejemplos -->
        <div class="slide gradient-bg-3 flex items-center justify-center p-8">
            <div class="max-w-6xl w-full text-white">
                <h2 class="text-5xl font-bold mb-8 text-center">Más Ejemplos Útiles</h2>
                <div class="space-y-6">
                    <div class="code-block">
                        <div class="bg-gray-700 px-4 py-2 flex items-center">
                            <i class="fas fa-box text-yellow-400 mr-3"></i>
                            <span class="font-semibold">Actualización Automática de Stock</span>
                        </div>
                        <pre><code class="language-sql" style="font-size: 1rem;">CREATE OR REPLACE TRIGGER trg_actualizar_stock
  AFTER INSERT ON ventas
  FOR EACH ROW
BEGIN
  UPDATE productos
  SET stock = stock - :NEW.cantidad
  WHERE id_producto = :NEW.id_producto;
END;
/</code></pre>
                    </div>
                    <div class="code-block">
                        <div class="bg-gray-700 px-4 py-2 flex items-center">
                            <i class="fas fa-exclamation-triangle text-red-400 mr-3"></i>
                            <span class="font-semibold">Validación de Duplicados</span>
                        </div>
                        <pre><code class="language-sql" style="font-size: 1rem;">CREATE OR REPLACE TRIGGER trg_validar_email
  BEFORE INSERT ON usuarios
  FOR EACH ROW
DECLARE
  v_count NUMBER;
BEGIN
  SELECT COUNT(*) INTO v_count FROM usuarios WHERE email = :NEW.email;
  IF v_count > 0 THEN
    RAISE_APPLICATION_ERROR(-20001, 'El email ya existe');
  END IF;
END;
/</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 9: Cierre -->
        <div class="slide gradient-bg-4 flex items-center justify-center p-8">
            <div class="text-center text-white">
                <i class="fas fa-rocket text-8xl mb-8 animate-bounce"></i>
                <h2 class="text-7xl font-bold mb-8">FIN!</h2>
                <p class="text-4xl mb-8 leading-relaxed max-w-4xl mx-auto">
                     <strong>...o no?</strong> 
                </p>
                <div class="bg-white bg-opacity-20 backdrop-blur-lg rounded-3xl p-8 max-w-3xl mx-auto border-2 border-white border-opacity-30">
                    <p class="text-2xl leading-relaxed">
                        Ahora nosotros!
                    </p>
                </div>
            </div>
        </div>

    </div>

    <!-- Navigation Controls -->
    <div class="fixed bottom-8 left-1/2 transform -translate-x-1/2 flex items-center gap-6 z-50">
        <button id="prevBtn" class="nav-btn bg-white text-gray-800 rounded-full p-4 shadow-2xl hover:shadow-xl">
            <i class="fas fa-chevron-left text-2xl"></i>
        </button>
        
        <div id="indicators" class="flex gap-3">
            <!-- Indicators will be generated by JS -->
        </div>
        
        <button id="nextBtn" class="nav-btn bg-white text-gray-800 rounded-full p-4 shadow-2xl hover:shadow-xl">
            <i class="fas fa-chevron-right text-2xl"></i>
        </button>
    </div>

    <!-- Slide Counter -->
    <div class="fixed top-8 right-8 bg-white bg-opacity-20 backdrop-blur-lg text-white px-6 py-3 rounded-full text-xl font-semibold z-50">
        <span id="currentSlide">1</span> / <span id="totalSlides">9</span>
    </div>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const indicators = document.getElementById('indicators');
        const currentSlideEl = document.getElementById('currentSlide');

        // Generate indicators
        for (let i = 0; i < totalSlides; i++) {
            const indicator = document.createElement('div');
            indicator.className = 'slide-indicator w-3 h-3 rounded-full bg-white bg-opacity-50 cursor-pointer';
            if (i === 0) indicator.classList.add('active');
            indicator.addEventListener('click', () => goToSlide(i));
            indicators.appendChild(indicator);
        }

        const indicatorDots = document.querySelectorAll('.slide-indicator');

        function updateSlide() {
            slides.forEach((slide, index) => {
                slide.classList.remove('active', 'prev');
                if (index === currentSlide) {
                    slide.classList.add('active');
                } else if (index < currentSlide) {
                    slide.classList.add('prev');
                }
            });

            indicatorDots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentSlide);
            });

            currentSlideEl.textContent = currentSlide + 1;
            
            prevBtn.style.opacity = currentSlide === 0 ? '0.5' : '1';
            prevBtn.style.cursor = currentSlide === 0 ? 'not-allowed' : 'pointer';
            nextBtn.style.opacity = currentSlide === totalSlides - 1 ? '0.5' : '1';
            nextBtn.style.cursor = currentSlide === totalSlides - 1 ? 'not-allowed' : 'pointer';

            // Highlight code in current slide
            setTimeout(() => {
                const activeSlide = slides[currentSlide];
                const codeBlocks = activeSlide.querySelectorAll('pre code');
                codeBlocks.forEach(block => {
                    hljs.highlightElement(block);
                });
            }, 100);
        }

        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                currentSlide++;
                updateSlide();
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                updateSlide();
            }
        }

        function goToSlide(index) {
            currentSlide = index;
            updateSlide();
        }

        nextBtn.addEventListener('click', nextSlide);
        prevBtn.addEventListener('click', prevSlide);

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') nextSlide();
            if (e.key === 'ArrowLeft') prevSlide();
        });

        // Initialize
        document.getElementById('totalSlides').textContent = totalSlides;
        updateSlide();
    </script>
</body>
</html>